<!DOCTYPE html>
<html>
  <head>
    <!--<title>My Awesome Presentation</title>-->
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" type="text/css" href="slides.css">
    <script src="remark.min.js"></script>
  </head>
  <body>
    <textarea id="source">

class: center, middle

# Операционные системы

#### Взаимодействие ОС и программы. Методы организации ОС

---
# Архитектура вычислителя

```asciidrawing
        +--------+       +--------+      +---------+
        |  CPU   |       | Memory |      | Devices |
        +--------+       +--------+      +---------+
            ^                ^                ^
            |                |                |
            v                v                v
Bus +---------------------------------------------------
    +---------------------------------------------------
```
Инициация обмена данными:
* СPU -> Memory
* CPU -> Controllers
* Devices -> Memory (DMA)

Сигнализация:
* Controllers-CPU

---
# Hello, World! Demo

```
int main(int argc, char *argv[]) {
	const char *msg = "Hello, World!\n";
	printf("%s", msg);
	return 0;
}
```

---
# Определения

* Процесс - исполняемая программа

Процесс ~ экземпляр виртуальной машины

---
# Исключения

1. Синхронные (внутренние)
 1. деление на ноль
 2. ошибки доступа к памяти
 3. инструкции программных исключений
 4. ...
2. Асинхронные (внешние)
 1. прерывания

---
# 2 режима работы

```asciidrawing
          +------------------+
          | Пользовательский |
          +------------------+
             |          ^
  Исключение |          | Выход из обработчика
             v          |
          +------------------+
          |    Системный     |
          +------------------+
```

---
# Обработка исключений

1. (*) Сохранение базового контекста CPU
2. (*) Подготовка контекста обработки исключения, переключение на него
3. Сохранение полного контекста
4. Обработка исключения
5. Acknowledgement исключения
6. Восстановление контекста

---
# Hello, World! Demo 2

```
__asm__ __volatile__(
	"int $0x81\n"
);
```

---
# Системный вызов

(3) Обработка на стеке приложения или ассоциированном с ним

(4) Синхронные исключения для системных вызовов

(6) Результат вызова записывается в контекст

---
# Монолитные ОС
Все функции находятся в ядре (выполняются в системном режиме)

Например, UNIX:
* Планировщики
* Драйвера устройств
* Сетевые протоколы, файловые системы
* Системные вызовы ФС, сети,...

---
# Микроядерные ОС
Основная часть находится в пользовательском режиме

Например, MINIX/L4 в ядре:
* планировщик
* исключения
* обмен сообщениями между процессами

Всё остальное реализуются системными процессами

---
# Экзоядерные ОС
В привелегированном режиме работают только мультиплексоры устройств

---
# Д/З: Шелл

Шелл - оболочка, процесс запрашивающий ввод и исполняющий программы
```
$ app1
Hello, World!
```
```
$ app1 Anton
Hello, Anton!
```
```
$ app1 ; app1 test
Hello, World!
Hello, test!
```

---
# Bourne shell

* `;`
* `&&`, `||`
* `if`, `while`, `case`, `for`
* `|`
* Переменные, функции, ...

http://www.tldp.org/HOWTO/VMS-to-Linux-HOWTO/examples.html

    </textarea>
    <script src="slides.js" type="text/javascript"></script>
  </body>
</html>
